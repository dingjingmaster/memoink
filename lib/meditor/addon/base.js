"use strict";import "../../layer/index.js";function objArr(t){let n=[];for(;t>0;)n.push({v:0}),t--;return n}function trim(t,n){return t.replace(new RegExp("^"+n+"|"+n+"$","g"),"")}const $doc=Anot(document),addon={h1:function(t){let n=this,i=Anot(t).offset(),e=this.selection(!0)||Anot.ui.meditor.lang.PLACEHOLDER;layer.open({type:7,menubar:!1,maskClose:!0,fixed:!0,insert:function(t){e=e.replace(/^(#{1,6} )?/,"#".repeat(t)+" "),n.insert(e,!0),this.close()},offset:[i.top+35-$doc.scrollTop(),"auto","auto",i.left-$doc.scrollLeft()],shift:{top:i.top-$doc.scrollTop(),left:i.left-$doc.scrollLeft()},content:`\n      <ul class="do-meditor-h1 do-fn-noselect">\n        <li :click="insert(1)" class="h1"><i class="do-meditor__icon icon-h1"></i>${Anot.ui.meditor.lang.HEADERS.H1}</li>\n        <li :click="insert(2)" class="h2"><i class="do-meditor__icon icon-h2"></i>${Anot.ui.meditor.lang.HEADERS.H2}</li>\n        <li :click="insert(3)" class="h3"><i class="do-meditor__icon icon-h3"></i>${Anot.ui.meditor.lang.HEADERS.H3}</li>\n        <li :click="insert(4)" class="h4"><i class="do-meditor__icon icon-h4"></i>${Anot.ui.meditor.lang.HEADERS.H4}</li>\n        <li :click="insert(5)" class="h5"><i class="do-meditor__icon icon-h5"></i>${Anot.ui.meditor.lang.HEADERS.H5}</li>\n        <li :click="insert(6)" class="h6"><i class="do-meditor__icon icon-h6"></i>${Anot.ui.meditor.lang.HEADERS.H6}</li>\n      </ul>`})},quote:function(t){let n=this.selection()||Anot.ui.meditor.lang.PLACEHOLDER;n="> "+n,this.insert(n,!0)},bold:function(t){let n=this.selection()||Anot.ui.meditor.lang.PLACEHOLDER,i=trim(n,"\\*\\*");n=n===i?"**"+n+"**":i,this.insert(n,!0)},italic:function(t){let n=this.selection()||Anot.ui.meditor.lang.PLACEHOLDER,i=trim(n,"_");n=n===i?"_"+n+"_":i,this.insert(n,!0)},through:function(t){let n=this.selection()||Anot.ui.meditor.lang.PLACEHOLDER,i=trim(n,"~~");n=n===i?"~~"+n+"~~":i,this.insert(n,!0)},unordered:function(t){let n=this.selection()||Anot.ui.meditor.lang.PLACEHOLDER;n="* "+n,this.insert(n,!1)},ordered:function(t){let n=this.selection()||Anot.ui.meditor.lang.PLACEHOLDER;n="1. "+n,this.insert(n,!1)},hr:function(t){this.insert("\n\n---\n\n",!1)},link:function(t){let n=this,i=Anot(t).offset(),e=this.selection()||"";layer.open({type:7,menubar:!1,maskClose:!0,fixed:!0,link:"",linkName:e,linkTarget:1,insert:function(){if(!this.link||!this.linkName)return layer.toast(Anot.ui.meditor.lang.LINK.ERROR,"error");let t=`[${this.linkName}](${this.link} ${1===this.linkTarget?' "target=_blank"':""})`;n.insert(t,!1),this.close()},offset:[i.top+35-$doc.scrollTop(),"auto","auto",i.left-$doc.scrollLeft()],shift:{top:i.top-$doc.scrollTop(),left:i.left-$doc.scrollLeft()},content:`\n      <div class="do-meditor-common">\n        <section>\n          <input class="do-meditor__input" :duplex="linkName" placeholder="${Anot.ui.meditor.lang.LINK.ALT}"/>\n        </section>\n        <section>\n          <input class="do-meditor__input" :duplex="link" placeholder="${Anot.ui.meditor.lang.LINK.URL}"/>\n        </section>\n        <section>\n          <label class="label">\n            <input \n              name="link" \n              type="radio" \n              class="radio" \n              :duplex-number="linkTarget" \n              value="1"/>\n            ${Anot.ui.meditor.lang.TARGET.BLANK}\n          </label>\n          <label class="label">\n            <input \n              name="link" \n              type="radio" \n              class="radio" \n              :duplex-number="linkTarget" \n              value="2"/>\n            ${Anot.ui.meditor.lang.TARGET.SELF}\n          </label>\n        </section>\n        <section>\n          <a \n            href="javascript:;" \n            class="do-meditor__button submit" \n            :click="insert">${Anot.ui.meditor.lang.BTN.YES}</a>\n        </section>\n      </div>`})},time:function(t){this.insert((new Date).format(),!1)},face:function(t){let n=this,i=Anot(t).offset();layer.open({type:7,title:Anot.ui.meditor.lang.LAYER.FACE_TITLE,fixed:!0,maskClose:!0,arr:["üòÄ","üòÖ","üòÇ","ü§£","üòá","üòâ","üòç","üòó","üòã","üòõ","üòú","ü§®","üßê","ü§ì","üòé","üòû","üòî","üò≠","üò§","üò°","üò±","üò∞","üòì","üò¨","üôÑ","üò¥","üò™","ü§Æ","üò∑","üí©","üëª","üíÄ","ü§ù","üëé","üëç","üôè"],offset:[i.top+35-$doc.scrollTop(),"auto","auto",i.left-$doc.scrollLeft()],shift:{top:i.top-$doc.scrollTop(),left:i.left-$doc.scrollLeft()},content:'\n        <ul class="do-meditor-face">\n          <li class="item" :for="arr">\n            <span :html="el" :click="insert(el)"></span>\n          </li>\n        </ul>',insert:function(t){n.insert(t,!1)}})},table:function(t){let n=this,i=Anot(t).offset();layer.open({type:7,title:`0 ${Anot.ui.meditor.lang.TABLE.ROW} x 0 ${Anot.ui.meditor.lang.TABLE.COLUMN}`,fixed:!0,maskClose:!0,offset:[i.top+35-$doc.scrollTop(),"auto","auto",i.left-$doc.scrollLeft()],shift:{top:i.top-$doc.scrollTop(),left:i.left-$doc.scrollLeft()},matrix:objArr(10).map(function(){return objArr(10)}),content:'\n      <ul class="do-meditor-table" ref="table">\n        <li :for="matrix">\n          <span \n            :for="o in el" \n            :class="{active: o.v}" \n            :data="{x: $index, y: $outer.$index}"></span>\n        </li>\n      </ul>',success:function(){let t,i,e=this.$refs.table,{lang:o}=Anot.ui.meditor;Anot(e).bind("mousemove",n=>{if("SPAN"===n.target.nodeName){let e=n.target.dataset.x-0,l=n.target.dataset.y-0;if(e===t&&l===i)return;t=e,i=l,this.title=`${l+1} ${o.TABLE.ROW} x ${e+1} ${o.TABLE.COLUMN}`;for(let t=0;t<=9;t++)for(let n=0;n<=9;n++)this.matrix[t][n].v=t<=l&&n<=e?1:0}}),Anot(e).bind("mouseleave",n=>{t=-1,i=-1,this.title=`0 ${o.TABLE.ROW} x 0 ${o.TABLE.COLUMN}`;for(let t=0;t<=9;t++)for(let n=0;n<=9;n++)this.matrix[t][n].v=0}),Anot(e).bind("click",t=>{if("SPAN"===t.target.nodeName){let i=t.target.dataset.x-0+1,e=t.target.dataset.y-0+1,l=`\n\n${("| "+o.TABLE.THEAD+" ").repeat(i)}|\n`,s=`${"| -- ".repeat(i)}|\n`,c=("|    ".repeat(i)+"|\n").repeat(e);n.insert(l+s+c,!1),this.close()}})}})},image:function(t){let n=this,i=Anot(t).offset(),e=this.selection()||"";layer.open({type:7,menubar:!1,maskClose:!0,fixed:!0,img:"",imgAlt:e,insert:function(){if(!this.img||!this.imgAlt)return layer.toast(Anot.ui.meditor.lang.LINK.ERROR,"error");let t=`![${this.imgAlt}](${this.img})`;n.insert(t,!1),this.close()},offset:[i.top+35-$doc.scrollTop(),"auto","auto",i.left-$doc.scrollLeft()],shift:{top:i.top-$doc.scrollTop(),left:i.left-$doc.scrollLeft()},content:`\n      <div class="do-meditor-common">\n        <section>\n          <input class="do-meditor__input" :duplex="imgAlt" placeholder="${Anot.ui.meditor.lang.IMAGE.ALT}"/>\n        </section>\n        <section>\n          <input class="do-meditor__input" :duplex="img" placeholder="${Anot.ui.meditor.lang.IMAGE.URL}"/>\n        </section>\n        <section>\n          <a \n            href="javascript:;" \n            class="do-meditor__button submit" \n            :click="insert">${Anot.ui.meditor.lang.BTN.YES}</a>\n        </section>\n      </div>\n      `})},attach:function(t){this.addon.link.call(this,t)},inlinecode:function(t){let n=this.selection()||Anot.ui.meditor.lang.PLACEHOLDER,i=trim(n,"`");n=n===i?"`"+n+"`":i,this.insert(n,!0)},blockcode:function(t){let n=this,i=Anot(t).offset();layer.open({type:7,menubar:!1,fixed:!0,__lang__:[{id:"asp"},{id:"actionscript",name:"ActionScript(3.0)/Flash/Flex"},{id:"bash",name:"Bash/Shell/Bat"},{id:"css"},{id:"c",name:"C"},{id:"cpp",name:"C++"},{id:"csharp",name:"C#"},{id:"coffeescript",name:"CoffeeScript"},{id:"d",name:"D"},{id:"dart"},{id:"delphi",name:"Delphi/Pascal"},{id:"erlang"},{id:"go",name:"Golang"},{id:"html"},{id:"java"},{id:"javascript"},{id:"json"},{id:"lua"},{id:"less"},{id:"markdown"},{id:"nginx"},{id:"objective-c"},{id:"php"},{id:"perl"},{id:"python"},{id:"r",name:"R"},{id:"ruby"},{id:"sql"},{id:"sass",name:"SASS/SCSS"},{id:"swift"},{id:"typescript"},{id:"xml"},{id:"yaml"},{id:"other",name:Anot.ui.meditor.lang.CODE.OTHER}],lang:"javascript",code:"",maskClose:!0,offset:[i.top+35-$doc.scrollTop()],shift:{top:i.top-$doc.scrollTop()},insert:function(){let t=`\n\`\`\`${this.lang}\n${this.code||"// "+Anot.ui.meditor.lang.PLACEHOLDER}\n\`\`\`\n`;n.insert(t,!1),this.close()},content:`\n      <div class="do-meditor-codeblock">\n        <section class="do-fn-cl">\n          <div class="select">\n            <select :duplex="lang">\n              <option :for="__lang__" :attr-value="el.id">{{el.name || el.id}}</option>\n            </select>\n            <span class="trigon">\n              <i class="do-icon-trigon-up"></i>\n              <i class="do-icon-trigon-down"></i>\n            </span>\n          </div>\n        </section>\n        <section>\n          <textarea class="do-meditor__input area" :duplex="code" placeholder="${Anot.ui.meditor.lang.PLACEHOLDER}"></textarea>\n        </section>\n        <section class="do-fn-cl">\n          <a \n            href="javascript:;" \n            class="do-meditor__button submit" \n            :click="insert">${Anot.ui.meditor.lang.BTN.YES}</a>\n        </section>\n      </div>\n      `})},preview:function(){this.preview=!this.preview,this.preview&&(this.htmlTxt=this.__tmp__)},fullscreen:function(){this.fullscreen=!this.fullscreen,this.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow="","function"==typeof this.props.onFullscreen&&this.props.onFullscreen(this.fullscreen)},about:function(t){let n=Anot(t).offset();layer.open({type:7,title:Anot.ui.meditor.lang.LAYER.ABOUT_TITLE,maskClose:!0,offset:[n.top+35-$doc.scrollTop()],shift:{top:n.top-$doc.scrollTop()},content:`<div class="do-meditor-about">\n        <pre>\n __  __ _____    _ _ _\n|  \\/  | ____|__| (_) |_ ___  _ __\n| |\\/| |  _| / _\` | | __/ _ \\| '__|\n| |  | | |__| (_| | | || (_) | |\n|_|  |_|_____\\__,_|_|\\__\\___/|_|    v${Anot.ui.meditor.version}</pre>\n        <p>${Anot.ui.meditor.lang.NAME}</p>\n        <p><a target="_blank" href="https://doui.cc/product/meditor">https://doui.cc/product/meditor</a></p>\n        <p>Copyright ¬© 2017 Yutent, The MIT License.</p>\n        </div>`})}};export default addon;